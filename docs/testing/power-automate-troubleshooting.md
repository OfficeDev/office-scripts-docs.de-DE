---
title: Problembehandlung bei Office Skripts, die in Power Automate ausgeführt werden
description: Tipps, Plattforminformationen und bekannte Probleme bei der Integration von Office Skripts und Power Automate.
ms.date: 05/18/2021
localization_priority: Normal
ms.openlocfilehash: 7ba128314c0d632a3e77792b7ee545bfb7dca71d
ms.sourcegitcommit: 4693c8f79428ec74695328275703af0ba1bfea8f
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 06/23/2021
ms.locfileid: "53074634"
---
# <a name="troubleshoot-office-scripts-running-in-power-automate"></a><span data-ttu-id="d76ca-103">Problembehandlung bei Office Skripts, die in Power Automate ausgeführt werden</span><span class="sxs-lookup"><span data-stu-id="d76ca-103">Troubleshoot Office Scripts running in Power Automate</span></span>

<span data-ttu-id="d76ca-104">Power Automate können Sie ihre Office Skriptautomatisierung auf die nächste Ebene bringen.</span><span class="sxs-lookup"><span data-stu-id="d76ca-104">Power Automate lets you take your Office Script automation to the next level.</span></span> <span data-ttu-id="d76ca-105">Da Power Automate jedoch Skripts in Ihrem Auftrag in unabhängigen Excel Sitzungen ausführt, sind einige wichtige Dinge zu beachten.</span><span class="sxs-lookup"><span data-stu-id="d76ca-105">However, because Power Automate runs scripts on your behalf in independent Excel sessions, there are a few important things to note.</span></span>

> [!TIP]
> <span data-ttu-id="d76ca-106">Wenn Sie gerade erst mit der Verwendung von Office Skripts mit Power Automate beginnen, beginnen Sie mit ["Ausführen Office Skripts" mit Power Automate,](../develop/power-automate-integration.md) um mehr über die Plattformen zu erfahren.</span><span class="sxs-lookup"><span data-stu-id="d76ca-106">If you're just starting to use Office Scripts with Power Automate, please start with [Run Office Scripts with Power Automate](../develop/power-automate-integration.md) to learn about the platforms.</span></span>

## <a name="avoid-relative-references"></a><span data-ttu-id="d76ca-107">Vermeiden von relativen Verweisen</span><span class="sxs-lookup"><span data-stu-id="d76ca-107">Avoid relative references</span></span>

<span data-ttu-id="d76ca-108">Power Automate führt Ihr Skript in der ausgewählten Excel Arbeitsmappe in Ihrem Namen aus.</span><span class="sxs-lookup"><span data-stu-id="d76ca-108">Power Automate runs your script in the chosen Excel workbook on your behalf.</span></span> <span data-ttu-id="d76ca-109">In diesem Fall wird die Arbeitsmappe möglicherweise geschlossen.</span><span class="sxs-lookup"><span data-stu-id="d76ca-109">The workbook might be closed when this happens.</span></span> <span data-ttu-id="d76ca-110">Jede API, die auf dem aktuellen Status des Benutzers basiert, z. B. `Workbook.getActiveWorksheet` , verhält sich in Power Automate möglicherweise anders.</span><span class="sxs-lookup"><span data-stu-id="d76ca-110">Any API that relies on the user's current state, such as `Workbook.getActiveWorksheet`, may behave differently in Power Automate.</span></span> <span data-ttu-id="d76ca-111">Dies liegt daran, dass die APIs auf einer relativen Position der Ansicht oder des Cursors des Benutzers basieren und dieser Verweis in einem Power Automate Fluss nicht vorhanden ist.</span><span class="sxs-lookup"><span data-stu-id="d76ca-111">This is because the APIs are based on a relative position of the user's view or cursor and that reference doesn't exist in a Power Automate flow.</span></span>

<span data-ttu-id="d76ca-112">Einige relative Referenz-APIs lösen Fehler in Power Automate aus.</span><span class="sxs-lookup"><span data-stu-id="d76ca-112">Some relative reference APIs throw errors in Power Automate.</span></span> <span data-ttu-id="d76ca-113">Andere weisen ein Standardverhalten auf, das den Status eines Benutzers impliziert.</span><span class="sxs-lookup"><span data-stu-id="d76ca-113">Others have a default behavior that implies a user's state.</span></span> <span data-ttu-id="d76ca-114">Achten Sie beim Entwerfen ihrer Skripts darauf, absolute Verweise für Arbeitsblätter und Bereiche zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-114">When designing your scripts, be sure to use absolute references for worksheets and ranges.</span></span> <span data-ttu-id="d76ca-115">Dadurch wird ihr Power Automate-Ablauf konsistent, auch wenn Arbeitsblätter neu angeordnet werden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-115">This makes your Power Automate flow consistent, even if worksheets are rearranged.</span></span>

### <a name="script-methods-that-fail-when-run-in-power-automate-flows"></a><span data-ttu-id="d76ca-116">Skriptmethoden, die beim Ausführen in Power Automate-Flüssen fehlschlagen</span><span class="sxs-lookup"><span data-stu-id="d76ca-116">Script methods that fail when run in Power Automate flows</span></span>

<span data-ttu-id="d76ca-117">Die folgenden Methoden lösen einen Fehler aus und schlagen fehl, wenn sie von einem Skript in einem Power Automate-Fluss aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-117">The following methods throw an error and fail when called from a script in a Power Automate flow.</span></span>

| <span data-ttu-id="d76ca-118">Klasse</span><span class="sxs-lookup"><span data-stu-id="d76ca-118">Class</span></span> | <span data-ttu-id="d76ca-119">Methode</span><span class="sxs-lookup"><span data-stu-id="d76ca-119">Method</span></span> |
|--|--|
| [<span data-ttu-id="d76ca-120">Chart</span><span class="sxs-lookup"><span data-stu-id="d76ca-120">Chart</span></span>](/javascript/api/office-scripts/excelscript/excelscript.chart) | `activate` |
| [<span data-ttu-id="d76ca-121">Range</span><span class="sxs-lookup"><span data-stu-id="d76ca-121">Range</span></span>](/javascript/api/office-scripts/excelscript/excelscript.range) | `select` |
| [<span data-ttu-id="d76ca-122">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-122">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveCell` |
| [<span data-ttu-id="d76ca-123">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-123">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveChart` |
| [<span data-ttu-id="d76ca-124">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-124">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveSlicer` |
| [<span data-ttu-id="d76ca-125">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-125">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRange` |
| [<span data-ttu-id="d76ca-126">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-126">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getSelectedRanges` |

### <a name="script-methods-with-a-default-behavior-in-power-automate-flows"></a><span data-ttu-id="d76ca-127">Skriptmethoden mit einem Standardverhalten in Power Automate Flüssen</span><span class="sxs-lookup"><span data-stu-id="d76ca-127">Script methods with a default behavior in Power Automate flows</span></span>

<span data-ttu-id="d76ca-128">Die folgenden Methoden verwenden ein Standardverhalten anstelle des aktuellen Status eines beliebigen Benutzers.</span><span class="sxs-lookup"><span data-stu-id="d76ca-128">The following methods use a default behavior, in lieu of any user's current state.</span></span>

| <span data-ttu-id="d76ca-129">Klasse</span><span class="sxs-lookup"><span data-stu-id="d76ca-129">Class</span></span> | <span data-ttu-id="d76ca-130">Methode</span><span class="sxs-lookup"><span data-stu-id="d76ca-130">Method</span></span> | <span data-ttu-id="d76ca-131">verhalten Power Automate</span><span class="sxs-lookup"><span data-stu-id="d76ca-131">Power Automate behavior</span></span> |
|--|--|--|
| [<span data-ttu-id="d76ca-132">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-132">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `getActiveWorksheet` | <span data-ttu-id="d76ca-133">Gibt entweder das erste Arbeitsblatt in der Arbeitsmappe oder das Arbeitsblatt zurück, das derzeit von der Methode aktiviert `Worksheet.activate` wird.</span><span class="sxs-lookup"><span data-stu-id="d76ca-133">Returns either the first worksheet in the workbook or the worksheet currently activated by the `Worksheet.activate` method.</span></span> |
| [<span data-ttu-id="d76ca-134">Arbeitsblatt</span><span class="sxs-lookup"><span data-stu-id="d76ca-134">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `activate` | <span data-ttu-id="d76ca-135">Markiert das Arbeitsblatt als aktives Arbeitsblatt für die Zwecke von `Workbook.getActiveWorksheet` .</span><span class="sxs-lookup"><span data-stu-id="d76ca-135">Marks the worksheet as the active worksheet for purposes of `Workbook.getActiveWorksheet`.</span></span> |

## <a name="data-refresh-not-supported-in-power-automate"></a><span data-ttu-id="d76ca-136">Datenaktualisierung in Power Automate nicht unterstützt</span><span class="sxs-lookup"><span data-stu-id="d76ca-136">Data refresh not supported in Power Automate</span></span>

<span data-ttu-id="d76ca-137">Office Skripts können Daten nicht aktualisieren, wenn sie in Power Automate ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-137">Office Scripts can't refresh data when run in Power Automate.</span></span> <span data-ttu-id="d76ca-138">Methoden, `PivotTable.refresh` z. B. "Nichts tun", wenn sie in einem Fluss aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-138">Methods such as `PivotTable.refresh` do nothing when called in a flow.</span></span> <span data-ttu-id="d76ca-139">Darüber hinaus löst Power Automate keine Datenaktualisierung für Formeln aus, die Arbeitsmappenlinks verwenden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-139">Additionally, Power Automate doesn't trigger a data refresh for formulas that use workbook links.</span></span>

### <a name="script-methods-that-do-nothing-when-run-in-power-automate-flows"></a><span data-ttu-id="d76ca-140">Skriptmethoden, die keine Aktionen ausführen, wenn sie in Power Automate Flüssen ausgeführt werden</span><span class="sxs-lookup"><span data-stu-id="d76ca-140">Script methods that do nothing when run in Power Automate flows</span></span>

<span data-ttu-id="d76ca-141">Die folgenden Methoden führen keine Aktionen in einem Skript durch, wenn sie über Power Automate aufgerufen werden.</span><span class="sxs-lookup"><span data-stu-id="d76ca-141">The following methods do nothing in a script when called through Power Automate.</span></span> <span data-ttu-id="d76ca-142">Sie werden weiterhin erfolgreich zurückgegeben und lösen keine Fehler aus.</span><span class="sxs-lookup"><span data-stu-id="d76ca-142">They still return successfully and don't throw any errors.</span></span>

| <span data-ttu-id="d76ca-143">Klasse</span><span class="sxs-lookup"><span data-stu-id="d76ca-143">Class</span></span> | <span data-ttu-id="d76ca-144">Methode</span><span class="sxs-lookup"><span data-stu-id="d76ca-144">Method</span></span> |
|--|--|
| [<span data-ttu-id="d76ca-145">PivotTable</span><span class="sxs-lookup"><span data-stu-id="d76ca-145">PivotTable</span></span>](/javascript/api/office-scripts/excelscript/excelscript.pivottable) | `refresh` |
| [<span data-ttu-id="d76ca-146">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-146">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllDataConnections` |
| [<span data-ttu-id="d76ca-147">Workbook</span><span class="sxs-lookup"><span data-stu-id="d76ca-147">Workbook</span></span>](/javascript/api/office-scripts/excelscript/excelscript.workbook) | `refreshAllPivotTables` |
| [<span data-ttu-id="d76ca-148">Arbeitsblatt</span><span class="sxs-lookup"><span data-stu-id="d76ca-148">Worksheet</span></span>](/javascript/api/office-scripts/excelscript/excelscript.worksheet) | `refreshAllPivotTables` |

## <a name="select-workbooks-with-the-file-browser-control"></a><span data-ttu-id="d76ca-149">Auswählen von Arbeitsmappen mit dem Dateibrowsersteuerelement</span><span class="sxs-lookup"><span data-stu-id="d76ca-149">Select workbooks with the file browser control</span></span>

<span data-ttu-id="d76ca-150">Beim Erstellen des **Ausführungsskriptschritts** eines Power Automate Flusses müssen Sie auswählen, welche Arbeitsmappe Teil des Flusses ist.</span><span class="sxs-lookup"><span data-stu-id="d76ca-150">When building the **Run script** step of a Power Automate flow, you need to select which workbook is part of the flow.</span></span> <span data-ttu-id="d76ca-151">Verwenden Sie den Dateibrowser, um Ihre Arbeitsmappe auszuwählen, anstatt den Namen der Arbeitsmappe manuell einzugeben.</span><span class="sxs-lookup"><span data-stu-id="d76ca-151">Use the file browser to select your workbook, instead of manually typing the workbook's name.</span></span>

:::image type="content" source="../images/power-automate-file-browser.png" alt-text="Die Skriptaktion Power Automate Ausführen mit der Browseroption &quot;Dateiauswahl anzeigen&quot;.":::

<span data-ttu-id="d76ca-153">Weitere Informationen zur Power Automate Einschränkung und eine Erläuterung möglicher Problemumgehungen für die dynamische Auswahl von Arbeitsmappen finden Sie [in diesem Thread im Microsoft Power Automate Community.](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#)</span><span class="sxs-lookup"><span data-stu-id="d76ca-153">For more context on the Power Automate limitation and a discussion of potential workarounds for the dynamic selection of workbooks, see [this thread in the Microsoft Power Automate Community](https://powerusers.microsoft.com/t5/Power-Automate-Ideas/Allow-for-dynamic-quot-file-quot-value-for-excel-quot-get-a-row/idi-p/103091#).</span></span>

## <a name="time-zone-differences"></a><span data-ttu-id="d76ca-154">Zeitzonenunterschiede</span><span class="sxs-lookup"><span data-stu-id="d76ca-154">Time zone differences</span></span>

<span data-ttu-id="d76ca-155">Excel Dateien haben keinen inhärenten Speicherort oder keine Zeitzone.</span><span class="sxs-lookup"><span data-stu-id="d76ca-155">Excel files don't have an inherent location or timezone.</span></span> <span data-ttu-id="d76ca-156">Jedes Mal, wenn ein Benutzer die Arbeitsmappe öffnet, verwendet seine Sitzung die lokale Zeitzone dieses Benutzers für Datumsberechnungen.</span><span class="sxs-lookup"><span data-stu-id="d76ca-156">Every time a user opens the workbook, their session uses that user's local timezone for date calculations.</span></span> <span data-ttu-id="d76ca-157">Power Automate verwendet immer UTC.</span><span class="sxs-lookup"><span data-stu-id="d76ca-157">Power Automate always uses UTC.</span></span>

<span data-ttu-id="d76ca-158">Wenn Ihr Skript Datumsangaben oder Uhrzeiten verwendet, kann es Verhaltensunterschiede geben, wenn das Skript lokal getestet wird und nicht, wenn es Power Automate ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="d76ca-158">If your script uses dates or times, there may be behavioral differences when the script is tested locally versus when it is run through Power Automate.</span></span> <span data-ttu-id="d76ca-159">mit Power Automate können Sie Zeiten konvertieren, formatieren und anpassen.</span><span class="sxs-lookup"><span data-stu-id="d76ca-159">Power Automate allows you to convert, format, and adjust times.</span></span> <span data-ttu-id="d76ca-160">Anweisungen zur Verwendung dieser Funktionen in Power Automate und Parametern finden Sie unter [Working with Dates and Times inside of your](https://flow.microsoft.com/blog/working-with-dates-and-times/) [ `main` flows: Pass data to a script](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) to learn how to provide that time information for the script.</span><span class="sxs-lookup"><span data-stu-id="d76ca-160">See [Working with Dates and Times inside of your flows](https://flow.microsoft.com/blog/working-with-dates-and-times/) for instructions on how to use those functions in Power Automate and [`main` Parameters: Pass data to a script](../develop/power-automate-integration.md#main-parameters-pass-data-to-a-script) to learn how to provide that time information for the script.</span></span>

## <a name="see-also"></a><span data-ttu-id="d76ca-161">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="d76ca-161">See also</span></span>

- [<span data-ttu-id="d76ca-162">Problembehandlung bei Office Skripts</span><span class="sxs-lookup"><span data-stu-id="d76ca-162">Troubleshoot Office Scripts</span></span>](troubleshooting.md)
- [<span data-ttu-id="d76ca-163">Ausführen Office Skripts mit Power Automate</span><span class="sxs-lookup"><span data-stu-id="d76ca-163">Run Office Scripts with Power Automate</span></span>](../develop/power-automate-integration.md)
- [<span data-ttu-id="d76ca-164">Excel Referenzdokumentation zu Online-Connectors (Business)</span><span class="sxs-lookup"><span data-stu-id="d76ca-164">Excel Online (Business) connector reference documentation</span></span>](/connectors/excelonlinebusiness/)
